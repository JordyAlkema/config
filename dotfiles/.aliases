#!/usr/bin/env bash

# Abbreviations {{{1

alias blt='bluetoothctl'

alias chrome='google-chrome-stable'

alias cra='npx create-react-app'
function crat {
    npx create-react-app "$@" --typescript
}

alias cr='cargo run --'
alias cb='cargo build -j 1'
alias ci='cargo install -j 1'

alias typesync='npx typesync'

alias g='git'

alias grm='go run main.go'

alias l='ll'

alias m='make'
alias mr='make run'

alias open='fork xdg-open'

alias per='pipenv run'

alias r='ranger'

alias codediff='code -n -d'
alias vimdiff='nvim -d'
alias se='sudoedit'
alias vp='vimpager'

alias sshkey='ssh-keygen -t ed25519 -C "$(whoami)@$(hostname)-$(date -I)"'
alias gpgkey='gpg --full-gen-key'

alias nw='new-wallpaper'

function upgrade {
    # yay -Syu --noconfirm --needed

    yay -Syu --mflags '--nocheck'
    antigen update
    rustup update
    cargo install-update -a
    # go get -u all
    # nvim TODO
    yarn global upgrade
    npm update -g
    pip-upgrade --user
}


# New Commands {{{1

function pip-upgrade {
    if [[ $1 == '--user' ]]; then
        pip list --outdated --format=freeze --user | grep -v '^\-e' | cut -d = -f 1 | xargs -n1 pip install -U --user
    else
        pip list --outdated --format=freeze | grep -v '^\-e' | cut -d = -f 1 | xargs -n1 pip install -U
    fi
}

function new-wallpaper {
    folder_path=$HOME/drive/images/desktop_wallpapers/other
    image_path=$(fd --full-path $folder_path --type f | shuf -n 1)
    feh --bg-scale $image_path
}

alias clean-tmp='sudo find /tmp -type f -atime +7 -delete'
alias clean-trash='find /home/cjbassi/trash -type f -atime +7 -delete'
# alias clear-temp='tmpreaper 7d /tmp'

function push-new-project {
    hub init
    hub add .
    hub commit -m "Initial commit"
    hub create
    hub push -u origin master
}

function prepend {
    cat - "$@" | sponge "$@"
}

function fork {
    nohup "$@" </dev/null >/dev/null 2>&1 &; disown
}

function mkcd {
    mkdir "$@"; cd "$@"
}

function fork-term {
    fork alacritty --working-directory .
}


# Settings {{{1

alias sudo='sudo '

alias rg='rg -S'

alias git='hub'

# alias ll='exa -AhgoF --group-directories-first --color=always'
alias ll='exa -aFl --group-directories-first --git'

alias makepkg='makepkg -si'

function yay {
    if [[ "$1" == "-S" ]]; then
        command yay "$@" --needed --mflags '--nocheck'
    elif [[ "$1" == "-R" ]]; then
        command yay "$@" --recursive
    else
        command yay "$@"
    fi
}

alias ps='ps aux'

# TODO progress1 and 2
# alias rsync='rsync -h --info=all2'
alias rsync='rsync -h --progress'

alias sshfs='sshfs -C -o reconnect'

alias su='sudo -E su -m'

alias uname='uname -a'

alias valgrind='colour-valgrind --leak-check=yes --track-origins=yes'

alias w='w -f'

alias cp='cp -iv'
alias mv='mv -iv'
alias rm='rmtrash -Id'
alias rmdir='rmdirtrash'
alias mkdir='mkdir -vp'
alias ln='ln -v'

alias df='df -h'
alias du='du -h'

alias g++='g++ -g -Wall'
alias gcc='gcc -g -Wall'

alias ncdu='ncdu --color dark -rr -x --exclude .git --exclude node_modules'

alias ls='exa'

alias df='pydf'

alias fd='fd --ignore-file ~/.ignore'

# running ranger in a subshell of an already running ranger just exists that shell
function ranger() {
    if [ -n "$RANGER_LEVEL" ]; then
        exit
    else
        command ranger "$@"
    fi
}
